index=your_index
| rex field=_raw "\"Description\"\s*:\s*\"(?<description>(?:[^\"\\\\]|\\\\.)*)\""
| eval description=replace(description, "\\\\\"", "\"")
| table description


 ...your search...
| bin _time span=1d
| stats count AS lockouts BY clustername, account, _time
| eval two=if(lockouts=2,1,0), three=if(lockouts=3,1,0)
| stats sum(two) AS days_with_2, sum(three) AS days_with_3 BY clustername, account
| sort clustername, account

<your base lockout search that yields _time clustername account>
| bin _time span=1d
| stats count AS cnt BY clustername, _time, account
| eval day=strftime(_time,"%Y-%m-%d")
| eventstats sum(cnt) AS cluster_total BY clustername, day
| eval t1_user = if(cnt>=2, account."(".cnt.")", null())
| eval t2_user = if(cluster_total>=3, cnt."::".account, null())
| stats values(t1_user) AS t1_users values(t2_user) AS t2_users max(cluster_total) AS cluster_total BY clustername, day
| eval t1_users=mvfilter(isnotnull(t1_users)), t2_users=mvfilter(isnotnull(t2_users))
| eval sorted_t2 = mvsort(t2_users)
| eval sorted_t2 = mvmap(sorted_t2, replace(sorted_t2,"(\\d+)::(.+)","\\2(\\1)"))
| eval "Threshold1: Same user ≥2 (per day)" = if(mvcount(t1_users)>0, mvjoin(t1_users," "), null())
| eval "Threshold2: Cluster ≥3 (all users)" = if(cluster_total>=3, mvjoin(sorted_t2," "), null())
| where isnotnull('Threshold1: Same user ≥2 (per day)') OR cluster_total>=3
| table day clustername "Threshold1: Same user ≥2 (per day)" "Threshold2: Cluster ≥3 (all users)" cluster_total
| sort day, clustername



index=your_index
| dedup action description clustername

"--- 1. Count per action and cluster (after dedup) ---"
| stats count by action, clustername

"--- 2. Unique descriptions per action + cluster (your added query) ---"
| stats values(description) as unique_descriptions by action, clustername

"--- 3. Most common (mode) description per action + cluster ---"
| stats mode(description) as common_description by action, clustername

"--- 4. Full summary: count, unique descriptions, most common description ---"
| stats count dc(description) as unique_descriptions_count mode(description) as most_common by action, clustername

"--- 5. Pivot table: Action vs Cluster (matrix view) ---"
| chart count over clustername by action

"--- 6. Cluster-level summary: actions, unique descriptions, most common description ---"
| stats count dc(description) as unique_descriptions_count values(action) as actions mode(description) as most_common by clustername


index=your_index
| dedup action description clustername
| stats 
    count AS total_events,
    dc(description) AS unique_description_count,
    values(description) AS unique_descriptions,
    mode(description) AS most_common_description
  by action, clustername
| table action, clustername, total_events, unique_description_count, most_common_description, unique_descriptions

