function buildDetailMarkdown(rows) {
  const headers = [
    "ClusterName",
    "ViewName",
    `StartLogical(${DAYS}dAgo)`,
    `EndLogical(${DAYS}dEnd)`,
    `Growth(${DAYS}d)`,
    `Growth%(${DAYS}d)`,
    "Logical",
    "Physical",
    "UniqueData",
    "StorageConsumed",
    "ResiliencyImpact",
    "DataReduction",
    "StorageReduction",
    "NumFiles",
    "NumDirs"
  ];

  const headerRow = "| " + headers.join(" | ") + " |";
  const separator = "| " + headers.map(() => "---").join(" | ") + " |";

  const bodyRows = rows.map((r) => {
    const vals = [
      r.ClusterName,
      r.ViewName,
      r.StartLogical,
      r.EndLogical,
      r.GrowthSize,
      r.PercentGrowth,
      r.Logical,
      r.Physical,
      r.UniqueData,
      r.StorageConsumed,
      r.ResiliencyImpact,
      r.DataReduction,
      r.StorageReduction,
      r.NumFiles,
      r.NumDirs
    ].map((v) => (v == null ? "" : String(v)));
    return "| " + vals.join(" | ") + " |";
  });

  const inner = [
    `ðŸ“… ${DAYS}-day window (used **only** for growth columns): ${startDateStr} â†’ ${endDateStr}`,
    "",
    "#### Cohesity Views â€“ Growth (30d) + Current Stats (All Helios Clusters)",
    "",
    headerRow,
    separator,
    ...bodyRows
  ].join("\n");

  // ðŸ‘‡ small font wrapper
  return `<div style="font-size: 11px; line-height: 1.3;">\n\n${inner}\n\n</div>`;
}
