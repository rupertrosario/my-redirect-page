foreach ($run in $runs) {
  $runId = $run.id
  if ($run.localBackupInfo) {
    foreach ($info in $run.localBackupInfo) {
      # Fetch progress and event logs for this run inside foreach
      $response1 = Invoke-WebRequest -Method Get -Uri "https://helios.cohesity.com/v2/data-protect/runs/$runId/progress?includeEventLogs=true" -Headers $headers -Body $body
      $rwap = $response1.Content | ConvertFrom-Json
      $errorMessages = $rwap.localRun.objects.events.message | Select-String "kFSError"

      $flatRuns += [pscustomobject]@{
        RunId = $runId
        RunType = $info.runType
        Status = $info.status
        Message = $info.message
        EventErrors = ($errorMessages -join "; ")
        StartTimeUsecs = $info.startTimeUsecs
        EndTimeUsecs = $info.endTimeUsecs
        Cluster = $cluster_name
        ProtectionGroup = $pgName
      }
    }
  }
}
