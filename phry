foreach ($runId in $runs.id) {
  $response1 = Invoke-WebRequest -Method Get -Uri "https://helios.cohesity.com/v2/data-protect/runs/$runId/progress?includeEventLogs=true" -Headers $headers -Body $body
  $rwap = $response1.Content | ConvertFrom-Json
  $errorMessages = $rwap.localRun.objects.events.message | Select-String "kFSError"

  $run = $runs | Where-Object { $_.id -eq $runId }
  if ($run.localBackupInfo) {
    foreach ($info in $run.localBackupInfo) {
      $flatRuns += [pscustomobject]@{
        RunId          = $runId
        RunType        = $info.runType
        Status         = $info.status
        Message        = $info.message
        EventErrors    = ($errorMessages | ForEach-Object { $_.ToString() }) -join "; "
        StartTimeUsecs = $info.startTimeUsecs
        EndTimeUsecs   = $info.endTimeUsecs
        Cluster        = $cluster_name
        ProtectionGroup= $pgName
      }
    }
  }
}
