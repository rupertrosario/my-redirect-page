export default async function () {
  console.log("ğŸ”‘ Testing Cohesity Helios API key manually...");

  // 1ï¸âƒ£ Paste your Helios API key here temporarily
  const apiKey = "PASTE_YOUR_API_KEY_HERE";   // remove after test!

  // 2ï¸âƒ£ Define test endpoint
  const url = "https://helios.cohesity.com/v2/mcm/cluster-mgmt/info";
  const headers = { accept: "application/json", apiKey };

  // 3ï¸âƒ£ Call Cohesity Helios
  const resp = await fetch(url, { headers });
  console.log(`â¡ï¸ HTTP status: ${resp.status}`);
  if (resp.status !== 200) throw new Error(`âŒ API key test failed (HTTP ${resp.status})`);

  // 4ï¸âƒ£ Parse and log result
  const data = await resp.json();
  const clusters = data?.cohesityClusters?.map(c => c.ClusterName) || [];
  console.log(`âœ… API key works! Found ${clusters.length} cluster(s): ${clusters.join(", ")}`);

  // 5ï¸âƒ£ Return output
  return { success: true, clusterCount: clusters.length, clusters };
}
