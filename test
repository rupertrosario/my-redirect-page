$results = @()

# force alertsList to be treated as an array, even if it's a single object
$alerts = @($json.alertsList)

foreach ($alt in $alerts) {

  if ($alt.alertCode -eq 'CE3601105') {

    $prop = $alt.propertyList | Where-Object { $_.key -eq 'node_ip' } | Select-Object -First 1
    $ip   = $prop.value
    if (-not $ip) { $ip = $prop.values }
    if (-not $ip) { continue }

    $results += [pscustomobject]@{
      AlertCode   = $alt.alertCode
      IP          = $ip
      ClusterName = $alt.clusterName
      ClusterId   = $alt.clusterId
      Severity    = $alt.severity
      AlertState  = $alt.alertState
      Id          = $alt.id
    }
  }
}

$results
