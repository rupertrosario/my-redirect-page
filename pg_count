$pgSummary = @()

foreach ($pg in $allProtectionGroups) {
    $pgId        = $pg.Id
    $pgName      = $pg.Name
    $clusterName = $pg.Cluster

    $url   = "https://helios.cohesity.com/v2/data-protect/protection-groups/$pgId/runs"
    $resp  = Invoke-WebRequest -Method Get -Uri $url -Headers $headers -Body $body
    $json  = $resp.Content | ConvertFrom-Json
    $runs  = if ($json -and $json.runs) { $json.runs } else { @() }

    $pgSummary += [pscustomobject]@{
        Cluster         = $clusterName
        ProtectionGroup = $pgName
        RunCount        = $runs.Count
    }
}

$pgSummary | Sort-Object Cluster, ProtectionGroup | Format-Table -AutoSize
