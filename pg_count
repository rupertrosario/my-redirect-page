$allPGRunCounts = @()

foreach ($pg in $allProtectionGroups) {
    $pgId        = $pg.ID
    $pgName      = $pg.Name
    $clusterName = $pg.Cluster

    $runUrl   = "https://helios.cohesity.com/v2/data-protect/protection-groups/$pgId/runs"
    $response = Invoke-WebRequest -Method Get -Uri $runUrl -Headers $headers
    $json     = $response.Content | ConvertFrom-Json
    $runs     = if ($json -and $json.runs) { $json.runs } else { @() }

    # Record just the run count (0 if none)
    $allPGRunCounts += [pscustomobject]@{
        Cluster         = $clusterName
        ProtectionGroup = $pgName
        RunCount        = $runs.Count
    }
}

# Final table
$allPGRunCounts | Sort-Object Cluster, ProtectionGroup | Format-Table -AutoSize
